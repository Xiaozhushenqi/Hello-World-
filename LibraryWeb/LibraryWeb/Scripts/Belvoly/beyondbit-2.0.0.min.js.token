/*!
 * Beyondbit Front-end Framework v2.0.0
 changeset 826 *
 * http://bsdn.beyondbit.com
 *
 * Copyright (c) 2015 xakoy
 * Released under the  license
 */
var Beyondbit=function(){var that={};that.registerNameSpace=function(a){for(var b=that,c=a.split("."),d=c.length,e=0;d>e;e++){var f=c[e];void 0===b[f]&&(b[f]={}),b=b[f]}return b},that.register=function(a,b){for(var c=a.split("."),d=that,e=0,f=c.length;f>e;e+=1){if(e==f-1)return void 0!==d[c[e]]?(d[c[e]]=$.extend({},d[c[e]],b(that)),!0):(d[c[e]]=b(that),!0);void 0===d[c[e]]&&(d[c[e]]={}),d=d[c[e]]}},that.regShort=function(a,b){if(void 0!==that[a])throw"["+a+"] : short : 已经注册";that[a]=b},that.isObjectExists=function(objectString){try{return eval("var tempObjetExists = "+objectString),!0}catch(e){}return!1},that.DESIGNATION="belvoly";var _identity=1;return that.getIdentity=function(){return _identity++},that}(),B=window.B=Beyondbit;!function(a){Array.prototype.indexOf||(Array.prototype.indexOf=function(b){var c=-1;return a.each(this,function(a,d){return d===b?(c=a,!1):void 0}),c}),Array.prototype.indexFun=function(b){var c=-1;return a.each(this,function(a,d){var e=b(d);return 1==e?(c=a,!1):void 0}),c}}(jQuery),function(a,b){function c(){return d.regional[b.CultureInfo.Current.get()]}var d=b.registerNameSpace("jQueryEx.Ajax");d.regional=[],d.regional[""]=d.regional["zh-CN"]={message:{title:"系统提示",actionName:"操作"},close:"关闭",ok:"确定",success:"{0} 成功！",loading:"正在{0}中..."},b.post=function(a,c,d,e){return b.ajax({type:"POST",url:a,data:c,success:d,dataType:e})},b.ajax=function(d){var e=a.extend(!0,c().message,d.message),f=e.title,g=d.regulate,h=d.beforeSend;h&&(d.beforeSend=function(){var a=h();return 0==a&&b.Web.MessageBox.loading(!1),a});var i=d.success;return d.success=function(a){if(b.Web.MessageBox.loading(!1),0==a.Flag)b.Web.MessageBox.alert(f,a.Message,c().close,"ERROR"),null!=g&&g.disabled(!1).show();else{var d=i(a);1==d&&b.Web.MessageBox.alert(f,c().success.bformat(e.actionName),c().ok,"SUCCESS")}},b.Web.MessageBox.loading(f,c().loading.bformat(e.actionName)),a.ajax(d)}}(jQuery,Beyondbit),function(a,b){b.regional=[],b.regional[""]=b.regional["zh-CN"]={prompt:"提示",del:"删除",data:"数据",someThingSaving:"{0}保存中..",confirmToDoSomeThing:"确定要{0}吗？"};var c=b.registerNameSpace("CultureInfo");c.Current=new function(){var a="zh-CN";this.get=function(){return a},this.set=function(b){a=b},this.getCommonRegional=function(){return this.getRegional(b.regional)},this.getRegional=function(a){return a[this.get()]||a[""]}}}(jQuery,Beyondbit),function(a,b){function c(){return K.regional[b.CultureInfo.Current.get()]}function d(b){b=a.extend(!0,{id:"opicker",title:c().title,width:600,height:500,objectCodes:[],objects:[],splitChar:",",selectMode:0,defaultValue:null,associatedNameControl:null,associatedValueControl:null,onSelectedValue:null},b),b.objects=b.objects||[];var d=b.objects;if(b.objectCodes&&a.each(b.objectCodes,function(a,b){d.push({code:b})}),0==d.length)throw new Error(c().notSetObjectCode);var g=this,h={self:this,options:b};h.names=[],h.values=[];var i,j;if(b.defaultValue?(i=b.defaultValue.name,j=b.defaultValue.value):(b.associatedValueControl&&(j=b.associatedValueControl.val()),b.associatedNameControl&&(i=b.associatedNameControl.val())),j&&(h.names=(i||"").splitRemoveEmptys(b.splitChar),h.values=(j||"").splitRemoveEmptys(b.splitChar),h.names.length!=h.values.length))throw new Error(c().defaultNamesLengthNotEqualValuesLength);h.root=e(b,h),h.selectMode=1==b.selectMode?J.SINGLE:J.MULTIPE;var k={};this.execEvent=function(a,b,c){var d=k[a];return d&&d.fire(b,c,h),!0},this.registerEvent=function(b,c){var d=k[b];d||(d=a.Callbacks(),k[b]=d),d.add(c)},this.value=function(c){if(!c){var d=a(".opicker-selector ul li",h.root),e=[];return d.each(function(){var b=a(this),c=a.extend(!0,{},b.data("node"),{});e.push(c)}),e}var f=a.map(c,function(a){return a.name}),g=a.map(c,function(a){return a.value}),i={name:f.join(b.splitChar),value:g.join(b.splitChar),names:f,values:g,nodes:c};b.associatedNameControl&&b.associatedNameControl.val(i.name),b.associatedValueControl&&b.associatedValueControl.val(i.value),b.onSelectedValue&&b.onSelectedValue(i)},this.registerEvent("removeSelectedItemed",H),this.registerEvent("removeSelectedIteming",function(b,c,d){var e=d.root,f=a("div.tab-item.current",e),g=a.fn.zTree.getZTreeObj(a("ul.ztree",f).attr("id"));y(g,b.data("value"),!1,!0)}),this.registerEvent("moveSelectedIteming",function(){return!0}),this.registerEvent("moveSelectedItemed",function(){}),this.registerEvent("clearSelectedItem",I),this.registerEvent("insertItem",function(b,c,d){var e=d.root,f=a(".opicker-selector",e),g=a("ul",f),h=F(c);g.append(h);var i=d.self;i.execEvent("selectedChanged")}),this.registerEvent("removeItem",function(b,c,d){var e=d.root,f=a(".opicker-selector",e),g=a("ul",f);a("li[data-value='{value}']".bformat(c),g).remove();var h=d.self;h.execEvent("selectedChanged")}),this.registerEvent("clearItem",function(a,b,c){var d=c.self;d.execEvent("clearSelectedItem",null,c),d.execEvent("selectedChanged")}),this.registerEvent("selectedChanged",function(a,b,c){var d=c.root;G(d)}),this.registerEvent("getOPickerValue",function(){var a=g.value();g.value(a)}),this.registerEvent("tabChanged",function(a,b,c){var d=w(c.root);x(d,c.values,!1)}),this.registerEvent("tabChanging",function(){}),f(h)}function e(d,e){var f=(e.self,m(d)),g=a(f),h=b.Web.WindowManager.create({id:d.id,title:d.title,width:d.width,height:d.height,shadow:!0,data:{inner:e},buttons:[{text:"<i class='fa fa-check'></i>{0}".bformat(c().buttons.ok),events:{click:function(){var a=Beyondbit.Web.WindowManager.findByID(d.id),c=a.Data.inner,e=c.self;return e.execEvent("getOPickerValue",null),b.Web.WindowManager.findByID(d.id).hide(),!1}}},{text:"<i class='fa fa-trash'></i>{0}".bformat(c().buttons.clear),events:{click:function(){var b=Beyondbit.Web.WindowManager.findByID(d.id),c=b.Data.inner,e=c.self;return e.execEvent("clearSelectedItem",a(this)),!1}}},{text:"<i class='fa fa-remove'></i>{0}".bformat(c().buttons.cancel),events:{click:function(){return Beyondbit.Web.WindowManager.findByID(d.id).hide(),!1}}}]});return h.setOptions({content:g,title:d.title,width:d.width,height:d.height}),h.Data.inner=e,h.show(),"none"==g.find("div.opicker-tree-direction").css("display")?g.find("div.tab").removeClass("tab-vertical"):g.find("div.tab").addClass("tab-vertical"),g}function f(a){var b=(a.self,a.root);h(b,a),i(b,a),g(b,a),j(b,a)}function g(b,c){var d=a(".opicker-selector",b),e=a("ul",d);a.each(c.values,function(a,b){var d={name:c.names[a],value:b};e.append(F(d))}),G(b)}function h(b,c){var d=c.self,e=a(".opicker-selector",b),f=a("ul",e);f.click(function(b){var c=a(b.target);if(c.is("i")){var e=c.parent(),f=d.execEvent("removeSelectedIteming",e);1==f&&e.remove();var f=d.execEvent("removeSelectedItemed",e);return!1}if(c.is("li")){var e=c,f=d.execEvent("clickSelectedItemed",e);1==f&&e.addClass("selected").siblings(".selected").removeClass("selected")}})}function i(b,c){var d=c.self,e=a(".opicker-selector",b),f=a("div.scontrol a[data-control]",e),g=a("ul",e);f.click(function(){var b=a(this),c=a("li",g),e=c.filter(".selected");if(0==e.length)return!1;var f=c.index(e),h=b.data("control"),i=d.execEvent("moveSelectedIteming",e,h);if(1!=i)return!1;if("up"==h){if(0==f)return!1;var j=e.prev(),k=e.detach();j.before(k)}else if("down"==h){if(f==c.length-1)return!1;var l=e.next(),k=e.detach();l.after(k)}return d.execEvent("moveSelectedItemed",e,h),!1})}function j(c,d){var e=d.self,f=d.options,g=f.objects,h=a(".tab",c),i=a(".tab-nav",h),j=a(".tab-content",h);a.each(g,function(c,d){d.config=d.config||{};var e=d.code,f=b.OPicker.getService(e);i.append("<li>{0}</li>".bformat(d.title||f.title));var g=a('<div class="tab-item"><div class="opicker-dock">'+'<ul class="ztree" id="opicker_ztree_{0}_{1}"></ul></div></div>'.bformat(e,b.getIdentity()));j.append(g),g.data("service-object",d)}),i.find(">li").each(function(c){a(this).click(function(){var f=j.find(".tab-item").eq(c);if(1!=f.data("service-init")){var g=f.data("service-object"),h=b.OPicker.getService(g.code);k(f,h,g,d),f.data("service-init",!0)}e.execEvent("tabChanging",i);var i=a(this);i.addClass("current").siblings(".current").removeClass("current"),f.addClass("current").siblings(".current").removeClass("current"),e.execEvent("tabChanged",i)})}).eq(0).trigger("click")}function k(b,c,d,e){var f={async:{enable:!0,url:c.getUrl.call(c,d.config),param:["value=code"]},showIcon:c.showIcon,dataFilter:c.dataFilter,serviceObject:d,service:c},g=f.service.getStaticDataSource.call(f.service,f.serviceObject.config,f.serviceObject);g?g=D(g,n(f)):f.isAsync=!0;var h=p(e,f);a.fn.zTree.init(a("ul.ztree",b),h,g),l(b,c,d,e)}function l(d,e,f,g){function h(c){p+=1;var d={keywords:c,requestIndex:p};d[b.Tenant.ACCESS_TOKEN_IDENTITY]=b.Tenant.getCurrentAccessToken(),a.ajax({url:k,data:d,dataType:"jsonp",success:function(a){q<=a.requestIndex&&(i(a.data),q=a.requestIndex)}})}function i(b){var c="";if(b&&b.length>0){var b=D(b);c=a.map(b,function(b){var c=a('<li data-name="{name}" title="{tip}" data-value="{value}">{text}</li>'.bformat(b));return c.data("data",b),c})}m.find("ul").html(c)}function j(a){o&&clearInterval(o),a?m.removeClass("hide").show():m.hide()}var k=e.getSearchUrl(f.config);if(k){d.prepend('<dl class="opicker-quicksearch"><dt>{title}:<dt><dd><input placeholder="{placeholder}" title="{placeholder}" type="text" name="key" /></dd><dd class="opicker-quicksearch-result hide" hidefocus="true"  tabIndex="8889"><ul></ul></dd></dl>'.bformat(c().search)),d.css("overflow","hidden");var l=a(".opicker-quicksearch",d),m=a(".opicker-quicksearch-result",d);a(".opicker-dock",d).height(d.parent().height()-l.outerHeight()),a("ul",l).click(function(b){var c=(a(this),a(b.target));if(c.is("li")){var d=c;if(!d.hasClass("noSelect")){d.addClass("selected");var e=E(d.data("data"));t.call(g,e,!0)}}});var n,o;m.blur(function(){j(!1)}).focus(function(){j(!0)}),a(":input[name=key]",l).focus(function(){j(!0)}).blur(function(){o&&clearInterval(o),o=setInterval(function(){j(!1)},300)}).on("input propertychange",function(){var b=a(this);return null!=n&&clearTimeout(n),b.val()-0==0?void i(null):void(n=setTimeout(function(){var a=b.val();h(a)},300))});var p=1,q=1}}function m(){var a='<div class="opicker">    <div class="opicker-tree">         <div class="opicker-tree-direction"></div>        <div class="tab tab-vertical">            <ul class="tab-nav"></ul>            <div class="tab-content"></div>        </div>    </div>    <div class="opicker-selector">        <div class="sbody">            <h4>'+c().select.selected+'：<strong>0</strong></h4>            <div class="scontrol">                <a href="#" class="btn btn-img" data-control="up" title="'+c().select.up+'">                    <i class="fa fa-arrow-circle-up "></i>                    <em>'+c().select.up+'</em>                </a>                <a href="#" class="btn btn-img" data-control="down" title="'+c().select.down+'">                    <i class="fa fa-arrow-circle-down"></i>                    <em>'+c().select.down+'</em>                </a>            </div>            <ul></ul>        </div>    </div>    <div class="clearfix"></div></div>';return a}function n(a){return function(b){return a.dataFilter(b,a.serviceObject.config,a.serviceObject)}}function o(a){return function(b,c){return a.showIcon(c,b,a.serviceObject.config,a.serviceObject)}}function p(b,c){var d=b.options,e=b.selectMode,f={view:{showIcon:o(c)},async:{enable:!0,autoParam:["id","name","value"],dataFilter:function(a,d,e){return e&&0!=e.length?(e=D(e,n(c)),u(e,b.values),e):null}},check:{enable:!0,chkboxType:{Y:"",N:""}},data:{simpleData:{enable:!0}},callback:{onCheck:function(c,f,g){if(2==d.selectMode)z.call(b,g.checked,g);else{var h=E(g),i=g.checked;if(t.call(b,h,g.checked),i){if(e==J.SINGLE){var j=a.fn.zTree.getZTreeObj(f);j.checkNode(g,!0,!0,!1)}r(h)}else s(h)}},beforeClick:function(b,c){var d=a.fn.zTree.getZTreeObj(b);return 1==c.isParent&&1==c.nocheck?d.expandNode(c):d.checkNode(c,null,!0,!0),!1},beforeAsync:function(a,b){return!b||0!=b.hasChilds},onExpand:function(a,b,c){2==d.selectMode&&c.checked&&C(c,!0)}}};return q(c,f),d.showIcon&&(f.view.showIcon=function(a,b){return d.showIcon(b)}),f}function q(c,d){if(c.isAsync){d.async.enable=!0,d.async.url=c.async.url,d.async.dataType="jsonp",d.async.cache=!0;var e=c.async.otherParam||[],f=b.Tenant.getCurrentAccessToken();f&&(e.push(b.Tenant.ACCESS_TOKEN_IDENTITY),e.push(f)),d.async.otherParam=e,c.async.param&&a.each(c.async.param,function(b,c){-1==a.inArray(c,d.async.autoParam)&&d.async.autoParam.push(c)})}}function r(){}function s(){}function t(a,b){var c=this,d=c.self,e=c.names,f=c.values,g=e.indexOf(a.name),h=f.indexOf(a.value);c.selectMode==J.SINGLE?(d.execEvent("clearItem",null),b?(f=[a.value],e=[a.name],d.execEvent("insertItem",null,a)):(f=[],e=[]),c.values=f,c.names=e):b?(-1==h&&(f.push(a.value),d.execEvent("insertItem",null,a)),-1==g&&e.push(a.name)):(-1!=h&&(f.splice(h,1),d.execEvent("removeItem",null,a)),-1!=g&&e.splice(g,1))}function u(b,c){b&&a.each(b,function(a,b){var d=c.indexOf(b.value);d>-1&&(b.checked=!0)})}function v(a){var b=w(a);b.checkAllNodes(!1)}function w(b){var c=a("div.tab-item.current",b);return a.fn.zTree.getZTreeObj(a("ul.ztree",c).attr("id"))}function x(b,c,d){d=d||!1,b.checkAllNodes(!1),c&&a.each(c,function(a,c){y(b,c,!0,d)})}function y(a,b,c,d){d=d||!1;var e=a.getNodeByParam("value",b);e&&a.checkNode(e,c,!0,d)}function z(b,c){if(b){var d=c.getParentNode();if(d){var e=!0;a.each(d.children,function(a,b){return 0==b.checked?(e=!1,!1):void 0}),e?(B(!0,d,!1),z(b,d)):B(!0,c,!0)}else B(!0,c,!0)}else B(!1,c,!0),A(c)}function A(b){var c=E(b);zTreeObject.checkNode(b,!1,!1,!1),s(c),t(c,!1);var d=b.getParentNode();d&&1==d.checked&&(a.each(d.children,function(a,b){if(1==b.checked){var c=E(b);r(c),t(c,!0)}}),A(d))}function B(a,b,c){var d=E(b);a?(zTreeObject.checkNode(b,!0,!1,!1),r(d),t(d,!0),1==c&&C(b,!0)):(zTreeObject.checkNode(b,!1,!1,!1),s(d),t(d,!1),1==c&&C(b,!1))}function C(b,c){var d=this,e=b.children;e&&e.length>0&&(1==c?a.each(e,function(a,b){var e=E(b);s(e),t(e,!1),d.checkNode(b,!0,!1,!1),C(b,c)}):a.each(e,function(a,b){var e=E(b);s(e),t(e,!1),d.checkNode(b,!1,!1,!1),C(b,c)}))}function D(b,c){var d=[];return b&&(c&&(b=c(b)),a.each(b,function(b,e){c&&(e=c(e));var f=a.extend(!0,{},e,{id:e.id||a.trim(e.value),name:a.trim(e.name),value:a.trim(e.value),text:e.text||e.name,pId:e.parentId,open:e.open,isParent:e.isParent});d.push(f);var g=function(b){b.nodes&&a.each(b.nodes,function(e,f){c&&(f=c(f));var h=a.extend(!0,{},f,{id:f.id||a.trim(f.value),name:a.trim(f.name),value:a.trim(f.value),text:f.text||f.name,pId:b.id,open:b.open,isParent:f.isParent});d.push(h),g(f)})};g(e)})),d}function E(a){return a}function F(b){var c=a('<li data-value="{value}"><i class="fa fa-remove"></i>{name}</li>'.bformat(b));return c.data("node",b),c}function G(b){var c=a(".opicker-selector",b),d=a("ul li",c);a("div.sbody > h4 strong",c).html(d.length)}function H(a,b,c){var d=c.self;d.execEvent("selectedChanged",null)}function I(b,c,d){d.names=[],d.values=[];var e=d.self,f=a(".opicker-selector",d.root),g=a("ul",f);g.html(""),v(d.root),e.execEvent("selectedChanged",null)}var J={SINGLE:"single",MULTIPE:"multiple"},K=b.registerNameSpace("OPicker");K.regional=[],K.regional[""]=K.regional["zh-CN"]={service:{notAllowRegisterCodeEmpty:"注册Code不能为空",repeatRegistered:"重复注册服务标识:{0}",useNotRegisteredCode:"使用无注册服务标识:{0}"},title:"对象选择器",notSetObjectCode:"没有填写选择对象Codes",defaultNamesLengthNotEqualValuesLength:"默认值的name和value的长度不一致!",buttons:{ok:"确定",clear:"清除",cancel:"取消"},search:{title:"搜索",placeholder:"输入关键字检索"},select:{selected:"已选择",up:"向上",down:"向下"}},K.select=function(a){new d(a)};var L={};K.registerService=function(b,d,e){var f=b;if(!arguments[0])throw Error(c().service.notAllowRegisterCodeEmpty);var g,h=a.type(arguments[0]);if("string"===h?g={code:f,title:d,url:e}:a.isFunction(arguments[0])||(g=arguments[0],f=g.code),L[f])throw Error(c().service.repeatRegistered.bformat(f));L[f]=a.extend(!0,{},{dataFilter:function(a){return a},getStaticDataSource:function(){return null},getSearchUrl:function(a){return this.searchUrl?this.getUrl(a,this.searchUrl):void 0},getUrl:function(a,b){return b||this.url},showIcon:function(){return!0}},g)},K.getService=function(a){var b=L[a];if(!b)throw Error(c().service.useNotRegisteredCode.bformat(a));return b}}(jQuery,Beyondbit),function(a,b){function c(a){return 0==a.indexOf("http://")?a:(window.SharedServiceHost||e)+a}function d(){return f.regional[b.CultureInfo.Current.get()]}var e="http://__PORTALURL__/SharedService",f=b.registerNameSpace("OPicker");f.regional["zh-CN"].services={orgUser:{title:"按部门"},roleUser:{title:"按角色"},org:{title:"部门"},role:{title:"角色"},source:{title:"选择"},orgDeputy:{title:"选择机构代表",notConfigHierarchyCode:"没有配置hierarchyCode参数"}},f.registerService({code:"orguser",title:d().services.orgUser.title,config:{isShowRoot:!1,rootOrgCode:null},searchUrl:c("/api/OrgAndUserQuery"),url:c("/api/OrgAndUser"),dataFilter:function(a,b){return 1==b.isShowRoot&&(a.open=!0),(a.isParent||null!=a.nodes&&a.nodes.length>0)&&(a.nocheck=!0),a},getUrl:function(a,c){var c=new b.Url(c||this.url);return a.rootOrgCode&&c.appendKey("rootCode",a.rootOrgCode),1==a.isShowRoot&&c.appendKey("isIncludeRoot",a.isShowRoot),c.toString()}}),f.registerService({code:"roleuser",title:d().services.roleUser.title,config:{isShowRoot:!1,code:null,appCode:null},url:c("/api/RoleAndUser"),dataFilter:function(a){return(a.isParent||null!=a.nodes&&a.nodes.length>0)&&(a.nocheck=!0),a},getUrl:function(a,c){var c=new b.Url(c||this.url);return a.code&&c.appendKey("code",a.code),a.appCode&&c.appendKey("appCode",a.appCode),c.toString()}}),f.registerService({code:"org",title:d().services.org.title,config:{isShowRoot:!1,rootOrgCode:null},url:c("/api/Org"),showIcon:function(){return!1},dataFilter:function(a,b){return 1==b.isShowRoot&&(a.open=!0),a},getUrl:function(a,c){var c=new b.Url(c||this.url);return a.rootOrgCode&&c.appendKey("rootCode",a.rootOrgCode),1==a.isShowRoot&&c.appendKey("isIncludeRoot",a.isShowRoot),c.toString()}}),f.registerService({code:"role",title:d().services.role.title,config:{appCode:null},url:c("/api/Role"),getUrl:function(a,c){var c=new b.Url(c||this.url);return a.appCode&&c.appendKey("appCode",a.appCode),c.toString()}}),f.registerService({code:"source",title:d().services.source.title,source:[],config:{},getStaticDataSource:function(a,b){return b.source}}),f.registerService({code:"orgdeputy",title:d().services.orgDeputy.title,url:c("/OrgDeputy/Org"),config:{hierarchyCode:null},showIcon:function(){return!1},dataFilter:function(a,b){return 1==b.isShowRoot&&(a.open=!0),a},getUrl:function(a){var c=new b.Url(this.url);if(!a.hierarchyCode)throw Error(d().services.orgDeputy.notConfigHierarchyCode);return c.appendKey("hierarchyCode",a.hierarchyCode),a.rootOrgCode&&c.appendKey("rootCode",a.rootOrgCode),1==a.isShowRoot&&c.appendKey("isIncludeRoot",a.isShowRoot),c.toString()}})}(jQuery,Beyondbit),function(a,b){var c=b.registerNameSpace("Tenant");c.ACCESS_TOKEN_IDENTITY="AccessToken",c.getCurrentAccessToken=function(){var b=a("#TENANT_ACCESSTOKEN");return b.length>0?b.val():void 0}}(jQuery,Beyondbit),function(a,b){function c(a){var b={},c=a.indexOf("?");if(-1!=c){var d=a.substring(c+1);strs=d.split("&");for(var e=0;e<strs.length;e++){var f=strs[e].split("="),g=f[0].toLowerCase();b[g]=f[1]||""}}return b}var d;Beyondbit.Url=d=function(a){var a=a||window.location.href;this.request=c(a),this.queryString=function(a){return a?this.request[a.toLowerCase()]:""},this.removeKey=function(b){if(!b)return"";var c=new RegExp("([?&]){0}=[^&]*".bformat(b),"ig");return a=a.replace(c,"$1")},this.appendKey=function(b,c){if(!b)return a;var d=a.indexOf("?")>-1,e="{0}{1}={2}".bformat(d?"&":"?",b,c);return a+=e},this.toString=function(){return a}},d.current=new b.Url,d.back=function(){return window.history.back(-1),!1},d.backAndRefresh=function(){var a=document.referrer;return a?window.location.href=a:d.back(),!1},d.refresh=function(){window.location.reload()},d.redirect=function(a){window.location.href=a}}(jQuery,Beyondbit||{}),function(a,b){var c=(b.registerNameSpace("Web"),b.registerNameSpace("Web.Layout"));c.fit=function(b,c,d){c=a.extend(!0,{autoElement:null,reserve:0},c,{});var e,f,g=a(b);c.autoElement?(f=a(c.autoElement),e=g):(f=g,e=g.parent()),d=d||e.height();var h=e.children(":visible:not(script)").not(f[0]),i=f.outerHeight()-f.height(),j=0;h.each(function(){j+=a(this).outerHeight()}),f.height(d-j-i-c.reserve)}}(jQuery,Beyondbit),function(a,b){function c(){return e.regional[b.CultureInfo.Current.get()]}function d(){var a=this;a.findByID=function(a,b){return b=b||window,b.Beyondbit.Web.MessageBox.ManagerHelper.findMessageBox(a)},a.create=function(a,b){return b=b||window,new b.Beyondbit.Web.MessageBox.init(a)}}var e=(b.registerNameSpace("Web"),b.registerNameSpace("Web.MessageBox"));e.regional=[],e.regional[""]=e.regional["zh-CN"]={messages:{ok:"确定",cancel:"取消",yes:"是",no:"否",close:"关闭"},sysTips:{title:"系统提示",loadingContent:"正在加载.."}},e.Icons={SUCCESS:"fa-check",ERROR:"fa-times",INFO:"fa-info",QUESTION:"fa-question",WARNING:"fa-warning",LOADING:"fa-spinner fa-spin"},e.alert=function(b,d,e,f){var g="alert";if(0==arguments.length)return Beyondbit.Web.MessageBox.Manager.findByID(g);var h,i,j,k,l,m=arguments.length;if(m>1)if(arguments[m-1]&&a.isFunction(arguments[m-1]))switch(l=arguments[m-1],m){case 2:i=b;break;case 3:h=b,i=d;break;case 4:h=b,i=d,k=e;break;default:h=b,i=d,k=e,j=f}else h=b,i=d,j=f,k=e;else i=b;h=h||c().sysTips.title,k=k||c().messages.ok,j=j||Beyondbit.Web.MessageBox.Icons.INFO;var n="";a.each(Beyondbit.Web.MessageBox.Icons,function(a,b){a==j&&(j=b,n="messagebox-"+a.toLowerCase())});var o=function(){l&&l()};return Beyondbit.Web.MessageBox.show({id:g,content:i,title:h,icon:j,btns:[{text:k,callback:o}],draggable:!0,closeBtn:{show:!0,callback:o,defindValue:null},className:n})},e.confirm=function(b,d,e,f){var g="confirm";if(0==arguments.length)return Beyondbit.Web.MessageBox.Manager.findByID(g);var h,i,j,k,l,m=arguments.length;if(m>1)if(arguments[m-1]&&a.isFunction(arguments[m-1]))switch(l=arguments[m-1],m){case 2:i=b;break;case 3:h=b,i=d;break;case 4:h=b,i=d,j=e;break;default:h=b,i=d,j=e,k=f}else h=b,i=d,j=e,k=f;else i=b;j=j||[c().messages.ok,c().messages.cancel],k=k||Beyondbit.Web.MessageBox.Icons.QUESTION;var n=function(a){l&&l(a)};return Beyondbit.Web.MessageBox.show({id:g,content:i,title:h,icon:k,draggable:!0,btns:[{text:j[0],callback:n,defindValue:!0},{text:j[1],callback:n,defindValue:!1}],closeBtn:{show:!0,callback:n,defindValue:!1}})},e.prompt=function(b,d,e,f,g){var h,i,j,k,l="prompt",m=arguments.length;if(0==m)return Beyondbit.Web.MessageBox.Manager.findByID(l);if(1==m)i=b;else if(arguments[m-1]&&a.isFunction(arguments[m-1]))switch(g=arguments[arguments.length-1],m){case 2:i=b;break;case 3:h=b,i=d;break;case 4:h=b,i=d,j=e;break;default:h=b,i=d,j=e,k=f}else h=b,i=d,j=e,k=f;j=j||"";var n=d+'\n<input type="text" name="txtpromptcontent" value="'+j+'" />';return k=k||Beyondbit.Web.MessageBox.Icons.QUESTION,Beyondbit.Web.MessageBox.show({id:l,title:h,content:n,icon:k,draggable:!0,btns:[{text:c().messages.ok,callback:function(){return g?g(this.rootNode.find(":text[name=txtpromptcontent]").val()):void 0},defindValue:""}],closeBtn:{show:!0,callback:g,defindValue:""}})},e.loading=function(d,e,f,g){var h,i,j,k,l="loading";if(a.isNumeric(d))h=d,i=e;else{if(0==d)return a("#"+l).hide(),!0;j=d,k=e,h=f,i=g}h&&setTimeout(function(){var a=!0;i&&(a=i()),0!=a&&Beyondbit.Web.MessageBox.loading(!1)},h);var m=b.Web.get_zIndex(),n=a("#"+l);0==n.length&&(a("body").append('<div id="loading" class="loading">  <div class="loading-content"></div></div>'),n=a("#"+l));var o="",e=k||c().sysTips.loadingContent;a.each(e,function(a){o+="<span>{0}</span>".bformat(e.charAt(a))}),n.css("z-index",m).find(">div").html(o),n.show()},e.Manager=new d,Beyondbit.register("Web.MessageBox",function(){return{hide:function(a){a=a||"gloabid";var b=Beyondbit.Web.MessageBox.Manager.findByID(a);return b&&b.hide(),b},show:function(a){return Beyondbit.Web.MessageBox.Manager.create(a).show()},init:function(b){var b=a.extend({id:"gloabid",title:"",content:null,btns:null,icon:null,closeBtn:{show:!0,callback:null,defindValue:null},width:400,maxHeight:500,shadow:!0,draggable:!1,className:null},b),d=Beyondbit.Web.MessageBox.Manager.findByID(b.id);if(d)return d._initData.options=b,d._init(d._initData),d;var e=this;Beyondbit.Web.MessageBox.ManagerHelper.addMessageBox(b.id,this);var f="messagebox_"+b.id,g=f+"_shadow",h=a("#"+f);0==h.length&&(a("body").append(' <div class="shadow" id="'+g+'"></div> <div class="messagebox" id="'+f+'">     <section class="shead"><h4>&nbsp;</h4></section>     <a href="" class="close" title="'+c().messages.close+'"><i class="fa fa-close"></i></a>     <section class="sbody">         <div class="sicon">             <span class="fa-stack fa-lg">                 <i class="fa fa-stack-2x fa-circle"></i>                 <i class="fa fa-stack-1x fa-info messagebox-icon" data-beforeicon="fa-info"></i>             </span>         </div>         <div class="scontent"></div>     </section>    <section class="sfoot"></section></div>'),h=a("#"+f));var i=a("#"+g);return e.rootNode=h,e._initData={root:h,rootShadow:i,options:b},e._init=function(b){var c=this,d=b.options,e=b.root;e.attr("class","messagebox"+(" "+d.className||""));var f=Beyondbit.Web.MessageBox.ManagerHelper.get_zIndex();i.css("z-index",f),e.css("z-index",f),d.closeBtn.show?e.find(" > .close").off("click").click(function(){var a=!0;return d.closeBtn.callback&&(a=d.closeBtn.callback.call(c,d.closeBtn.defindValue)),0!=a&&c.hide(),!1}):e.find(" > .close").hide(),d.draggable&&e.draggable&&1!=c.draggableDone&&(a(" > .shead > h4",e).css({cursor:"move"}),e.draggable({cursor:"move",handle:"> .shead > h4",containment:"window"}),c.draggableDone=!0),e.find(" > .shead > h4").html(d.title||"&nbsp;");var g=a(".messagebox-icon",e),h=g.data("beforeicon"),j=d.icon||"fa-info";h!==j&&(g.removeClass(h).addClass(j),g.data("beforeicon",j)),a(".scontent",e).html(d.content);var k=a(".sfoot",e).html("");d.btns&&d.btns.length>0?(k.show(),a.each(d.btns,function(b,d){var e=a('<a href="#" class="btn"><i class="fa {icon}"></i>{text}</a>'.bformat({text:d.text,icon:d.iconclass||d.icon})).click(function(){var a=!0;return d.callback&&(a=d.callback.call(c,d.defindValue)),0!=a&&c.hide(),!1});k.append(e)})):k.hide();var l=a(window).width(),m=a(window).height()-20,n=Math.min(d.maxHeight,m),o=e.height(),p=Math.min(d.width,l);if(o>n){o=n;var q=o-a(".shead",e).height()-a(".sfoot",e).height()-40;a(".sbody",e).height(q)}e.css({width:p+"px","margin-left":"0","margin-top":"0",left:(l-p)/2+"px",top:(m-o)/2+"px"})},e._init(e._initData),e.hide=function(){return h.hide(),i.hide(),e},e.show=function(){return h.show(),b.shadow?i.show():i.hide(),e},e.show(),e}}}),Beyondbit.register("Web.MessageBox",function(){return{ManagerHelper:{get_zIndex:function(){return b.Web.get_zIndex()},_Queue:{},addMessageBox:function(a,b){Beyondbit.Web.MessageBox.ManagerHelper._Queue[a]=b},findMessageBox:function(a){var b=Beyondbit.Web.MessageBox.ManagerHelper;for(var c in b._Queue)if(c==a)return b._Queue[a];return null}}}})}(jQuery,Beyondbit),function(a,b){function c(){this.findByID=function(a,b){return b=b||window,b.Beyondbit.Web.WindowManagerHelper.findWindow(a)},this.findForParentByID=function(a){return this.findByID(a,parent)},this.create=function(a,b,c){if(b=b||window,c=c||"once","always"==c){var d=this.findByID(a.id,b);d&&d.destory()}return new b.Beyondbit.Web.Window(a)},this.get=function(c,d){if(c&&"string"==a.type(c))return b.Web.WindowManager.findByID(c,d);d=c,d=d||parent;var e=b.Url.current,c=e.queryString("DialogId");return this.findByID(c,d)}}function d(){return f.Window.regional[b.CultureInfo.Current.get()]}function e(){var b=d().loading,c="";return a.each(b,function(a){c+="<span>{0}</span>".bformat(b.charAt(a))}),c}var f=b.registerNameSpace("Web");f.WindowManager=new c,f.Window=function(c){var c=a.extend({id:"",shadow:!1,draggable:!0,loading:"normal",width:400,height:100,content:null,title:"",url:"",buttons:[],data:{},requestData:{},onOk:null,onClose:null,onCancel:null},c);if(this.ID=c.id,!this.ID||""==this.ID)throw d().notAllowIdIsEmpty;var f=this;this.Data=c.data;var g=Beyondbit.Web.WindowManager,h=g.findByID(this.ID);if(h)return h;Beyondbit.Web.WindowManagerHelper.addWindow(this.ID,this);var i=Beyondbit.Web.WindowHelper;this.ElementID="mzj_"+this.ID+"_box";var j={frameUrl:"",rootElement:null,contentMode:"iframe"},k="";k=k+'<div id="'+this.ElementID+'_shadow" class="shadow window-shadow"  style="display:none;"></div>',k=k+'<div id="'+this.ElementID+'" class="window" style="display:none;"><div class="window-box"><section class="shead">    <h3>'+c.title+'</h3></section><section class="sbody">    <iframe src="#" frameborder="0" scrolling="auto"></iframe>     <section class="scontainer"></section></section><section class="sfoot"></section><div class="window-loading loading">		<div class="loading-content">'+e()+"		</div>	</div>"+'<a href="#" class="close btn btn-img" onclick="return false;" title="{0}"><i class="fa fa-times-circle"></i><label>{0}</label></a>'.bformat(d().buttons.close)+"</div>",a("body").append(k);var l=j.rootElement=a("#"+this.ElementID),m=a("#"+this.ElementID+"_shadow"),n=a("> .window-box",l);a("a.close",l).click(function(){c.onClose&&c.onClose("close"),f.hide()});var o=c.buttons;if(o&&o.length>0){n.addClass("window-style-foot");var p=a(".sfoot",l);a.each(o,function(b,c){var d=a('<a href="#" onclick="return false;" class="btn"><span class="icon icon-'+c.icon+'"></span>'+c.text+"</a>");c.events&&a.each(c.events,function(a,b){d.on(a,b)}),p.append(d)})}return c.draggable&&l.draggable&&(a("section.shead > h3",l).css({cursor:"move"}),l.draggable({cursor:"move",handle:"section.shead > h3",containment:"window"})),this.getOptions=function(){return c},this.show=function(){f.message({hide:!0});var a=b.Web.get_zIndex(2);return l.css("z-index",a).show(),"none"!==c.loading&&f.message({title:d().loading,content:""}),c.shadow&&m.css("z-index",a-1).show(),"iframe"==j.contentMode?l.find("iframe").attr("src",j.frameUrl).css({display:"block",visibility:"visible"}).siblings().hide():(l.find(".scontainer").show().siblings().hide(),f.message({hide:!0})),f},this.message=function(b){var c=a.extend({hide:!1,title:d().loading,content:""},b);return i.message(f,c,j),l.show(),f},this.setOptions=function(b){return c=a.extend(c,b),i.initWindow(f,c,j),f},this.close=function(a,b){return c.onClose&&c.onClose.call(this,a,b),this.hide(),f},this.ok=function(a){var b=!1;return c.onOk&&(b=!0,c.onOk.call(this,a)),c.onClose&&(b=!0,c.onClose.call(this,"ok",a)),b||this.hide(),f},this.cancel=function(a){var b=!1;return c.onCancel&&(b=!0,c.onCancel.call(this,a)),c.onClose&&(b=!0,c.onClose.call(this,"cancel",a)),b||this.hide(),f},this.hide=function(){return l.find("iframe").css("visibility","hidden"),m.hide(),setTimeout(function(){l.hide()},50),f},this.destory=function(){l.remove(),m.remove(),Beyondbit.Web.WindowManagerHelper.removeWindow(this.ID)},i.initWindow(f,c,j),f},f.Window.regional=[],f.Window.regional[""]=f.Window.regional["zh-CN"]={notAllowIdIsEmpty:"组件Id不能为空",loading:"正在加载..",buttons:{close:"关闭"}},Beyondbit.register("Web",function(){return{WindowHelper:{initWindow:function(b,c,e){var f=c.content?"content":"iframe",g=e.rootElement,h=c.url.indexOf("?")>-1?"&":"?",i=c.url+h+"DialogId="+b.ID;for(var j in c.requestData){var k=c.requestData[j];i=i+"&"+j+"="+encodeURIComponent(k)}e.frameUrl=i,e.contentMode=f,"iframe"==f&&a("iframe",g).length>0&&(a("iframe",g)[0].onreadystatechange=a("iframe",g)[0].onload=function(){return this.readyState&&"complete"!=this.readyState?void("away"==c.loading&&Beyondbit.Web.WindowHelper.message(b,{title:d().loading,content:""},e)):void Beyondbit.Web.WindowHelper.message(b,{hide:!0},e)}),a("section.scontainer",g).html(c.content),a("section.shead h3",g).html(c.title);var l=a(window).height()-20;l>c.height&&(l=c.height);var m=a(window).width()-20;m>c.width&&(m=c.width),g.css({width:m+"px",height:l+"px"}),0==a.support.boxSizing&&g.css({"margin-left":"-"+m/2+"px","margin-top":"-"+l/2+"px"});
var n=a(window).width(),o=a(window).height()-20;g.css({width:m+"px","margin-left":"0","margin-top":"0",bottom:"auto",right:"auto",left:(n-m)/2+"px",top:(o-l)/2+"px"});var p=l-a("section.shead",g).height(),q=a("> .window-box",g),r=a("section.sfoot",g);return q.hasClass("window-style-foot")&&(g.find("section.sbody").addClass("dialog_container_layout_nobuttons"),p-=r.outerHeight()),g.find("section.sbody").height(p),b},message:function(b,c,d){if(1==c.hide)a(".window-loading",d.rootElement).hide();else{var e="",f=c.title;a.each(f,function(a){e+="<span>{0}</span>".bformat(f.charAt(a))}),a(".window-loading",d.rootElement).find(".loading-content").html(e),a(".window-loading",d.rootElement).show()}}},WindowManagerHelper:{_Queue:{},addWindow:function(a,b){Beyondbit.Web.WindowManagerHelper._Queue[a]=b},findWindow:function(a){var b=Beyondbit.Web.WindowManagerHelper._Queue[a];return b?b:null},removeWindow:function(a){delete Beyondbit.Web.WindowManagerHelper._Queue[a]}}}})}(jQuery,Beyondbit),function(a,b){var c=b.registerNameSpace("Web"),d=100;c.get_zIndex=function(a){return d+=a||1}}(jQuery,Beyondbit),function(){Date.prototype.bformat=function(a){var b={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var c in b)new RegExp("("+c+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?b[c]:("00"+b[c]).substr((""+b[c]).length)));return a}}(),function(a){var b=1024,c=1024*b,d=1024*c,e=1024*d;a.extend({GetAutoSizeString:function(a,f){return b>a?Math.round(a,f)+"B":c>a?Math.round(a/b,f)+"KB":d>a?Math.round(a/c,f)+"MB":e>a?Math.round(a/d,f)+"GB":Math.round(a/e,f)+"TB"}})}(jQuery),function(){String.prototype.bformat=function(a){var b=this;if(arguments.length>0)if(1==arguments.length&&"object"==typeof a)for(var c in a){var d=new RegExp("({"+c+"})","g");b=b.replace(d,a[c]||"")}else for(var e=0;e<arguments.length;e++){var d=new RegExp("({["+e+"]})","g"),f=arguments[e];b=b.replace(d,null==f||void 0==f?"":f)}return b},String.prototype.parseToDate=function(){var a=this,b=a.indexOf("/Date");return 0==b?(a=a.substring(6,a.length-2),new Date(a-0)):(a=a.replace(/-/g,"/"),new Date(a))},String.prototype.splitRemoveEmptys=function(a,b,c){var d=this.split(a,b||1e3);if(0!=c&&(c=!0),c)for(var e in d)d[e]-0==0&&d.splice(e,1);return d}}(),function(a,b){function c(){return e.regional[b.CultureInfo.Current.get()]}function d(){return{align:h.Center,pageSize:15,count:0,currentPageIndex:0,type:g.Get,pageIndexChanging:null,linkTo:window.location.href,prevText:c().prevText,nextText:c().nextText,pageIndexParamName:"pageIndex",pageSizeParamName:"pageSize",pageSizeItems:[10,15,20,50],mode:0,prevShowAlways:!0,nextShowAlways:!0,addToUrlDomIds:[],postForm:a("form:first")}}var e=b.registerNameSpace("jQueryEx.Pager");e.regional=[],e.regional[""]=e.regional["zh-CN"]={prevText:"上一页",nextText:"下一页",pageCurrent:"当前页",pageTotal:"总页数",pageSize:"每页",recordTotal:"总数",redirect:"跳转至",recordUnit:"条"};var f="pager",g={Get:"get",Post:"post"},h={Left:"left",Center:"center",right:"right"},i=function(){};i.addToUrlParam=function(a,b,c){var d=b+"="+encodeURIComponent(c),e=a.split("?"),f=e[0],g=e.length>1?e[1]:"",h=[];if(!(g.length>0))return a+"?"+d;if(-1==g.indexOf(b))return a+"&"+d;h=g.split("&");for(var i=0,j="";;){if(i>=h.length)return f+"?"+j+d;var k=h[i];0!=k.indexOf(b+"=")&&0!=k.length&&(j+=k+"&"),++i}},i.makePagingUrl=function(b,c,d){var e=b.linkTo,f=b.addToUrlDomIds,g={};g[b.pageIndexParamName]=c,g[b.pageSizeParamName]=d;for(var h=0;h<f.length;++h){var j=f[h],k=i.getElementsByIdOrName(j);null!=k&&(g[j]=a(k).val())}for(var l in g)e=i.addToUrlParam(e,l,g[l]);return e},i.getElementsByIdOrName=function(a){var b=document.getElementById(a);return null==b?document.getElementsByName(a):b},i.renderPageStatisticsItem=function(a,b,c,d){a.append('<li class="'+b+'">'+c+"<strong>"+d+"</strong>&nbsp;</li>")},i.renderPageNavigationItem=function(a,b,c){a.append('【<a class="'+b+'">'+c+"</a>】")},i.renderPageStatistics=function(a,b,d,e,f){i.renderPageStatisticsItem(a,"lab-pagecurrent",c().pageCurrent+":",b),i.renderPageStatisticsItem(a,"lab-pagetotal",c().pageTotal+":",d),i.renderPageStatisticsItem(a,"lab-pagesize",c().pageSize+":",e),i.renderPageStatisticsItem(a,"lab-recordtotal",c().recordTotal+":",f)},i.renderPageNavigation=function(b,c){var d=a("<li>").addClass("control");c.prevShowAlways&&i.renderPageNavigationItem(d,"prev",c.prevText),c.nextShowAlways&&i.renderPageNavigationItem(d,"next",c.nextText),b.append(d)},i.renderPageSizeOptions=function(b,d){var e="<li class=pagesize>"+c().pageSize+"&nbsp;<select>";a.each(d.pageSizeItems,function(a,b){var c=b==d.pageSize?"selected":"";e+="<option value="+b+" "+c+">"+b+"</option>"}),e+="</select>&nbsp;"+c().recordUnit+"&nbsp;</li>",b.append(e)},i.renderPageRedirect=function(b){var d=a("<li>").addClass("redirect");d.append(c().redirect+" <input type=text name=page /> <a href=#>GO</a>"),b.append(d)},i.calulatePageIndex=function(a,b){return Math.ceil(a/b)-1},a.fn.pager=function(b){var c=a.data(this,f);if(c)return c;a.data(this,f,this);var e=this,h=a("<ul>"),j=a.extend(d(),b);return this.setOptions=function(b){j=a.extend(j,b);var c=j.count,d=j.pageSize;if(!(0>=c||0>=d)){var f=j.currentPageIndex,g=j.mode,h=i.calulatePageIndex(c,d)+g;f>h||d>=c||(j.pageIndex=h,e.render(j,h,g))}},this.render=function(b,c,d){var f=b.type.toLowerCase(),i=a(b.postForm).clone();0==i.length&&(f=g.Get),b.postType=f,b.postForm=i,e.renderChildControls(h,b,c,d),e.bindChildControlsEvent(h,b,c,d)},this.renderChildControls=function(b,c,d,f){var g=c.count,h=c.pageSize,j=c.currentPageIndex;i.renderPageStatistics(b,j-f+1,d+1,h,g),i.renderPageNavigation(b,c),i.renderPageSizeOptions(b,c),i.renderPageRedirect(b),a(e).addClass("pagination").empty().append(b)},this.bindChildControlsEvent=function(b,c,d,f){var h=c.currentPageIndex,i=c.postType,j=b.find("a[class='prev']"),k=b.find("a[class='next']");i==g.Get?(j.each(function(b,c){e.doPageCore(h-1,a(c))}),k.each(function(b,c){e.doPageCore(h+1,a(c))})):(j.click(function(){e.doPage(h-1)}),k.click(function(){e.doPage(h+1)})),b.find("li[class='pagesize'] > select").change(function(){c.pageSize=a(this).val(),e.doPage(0+f)}),b.find("li[class='redirect'] > a").click(function(){var b=a(this).prev().val();0!=b.length&&e.doPage(parseInt(b)-1+f)})},this.doPageCore=function(c,d){var f=j.pageSize,h=j.pageIndex,k=j.mode,l=j.pageIndexChanging,m=j.postType,n=j.postForm;if(a.isFunction(l))return void l.call(e,c,b);if(!(0>c-k||c+k>h)){var o=i.makePagingUrl(j,c,f);m==g.Post?(a(document.body).append(n.hide()),n.attr({method:m,action:o}).submit()):m==g.Get&&(d?d.attr("href",o):window.location.href=o)}},this.doPage=function(a){e.doPageCore(a,null)},this.init=function(){e.setOptions(b)},e.init(),e}}(jQuery,Beyondbit),function(a,b){var c=b.registerNameSpace("Controls");a.fn.Form=function(d){var e="{0}_Form".bformat(b.DESIGNATION);if(0==this.length)return null;if(!d){var f=this.eq(0).data(e);if(f)return f}var g=this.eq(0);d=a.extend(!0,{},{target:g},d);var h=c.Form.create(d);return g.data(e,h),h}}(jQuery,Beyondbit),function(a,b){function c(a,b){var c=e(a,b.regulate);a.submit(function(){return a.valid?void(a.valid()&&d(a,c,b)):void d(a,c,b)})}function d(a,c,d){1==d.isSubmitShowLoading&&b.Web.MessageBox.loading(null,d.loadingMessage),null!=c&&c.disabled()}function e(b,c){var d;return c&&"string"===a.type(c)&&(d=b.Regulate(c)),d}function f(c){var d=b.CultureInfo.Current.getCommonRegional(),e=a.extend(!0,{regulate:null,target:null,isSubmitShowLoading:!0,loadingMessage:d.someThingSaving.bformat(d.data)},{},c);return g(e),e}function g(a){h(a,"target",null,"{0}参数必填")}function h(a,b,c,d){if(a[b]==c)throw new Error((d||"参数配置不正确").bformat(b))}var i=b.registerNameSpace("Controls"),j=i;j.Form=function(b){b=f(b);var d=a(b.target);c(d,b)},j.Form.create=function(a){return new j.Form(a)}}(jQuery,Beyondbit),function(a,b){function c(a){var b={options:a,sender:this};return b.childs=[],b}function d(b,c,d){var g=b.target||b.selectValueToControl||b.selectTextToControl,h=a.extend(!0,{},{},b);if(0==c)h.async.enable=!0,h.async.url=h.async.rawUrl;else{var i=d.childs[c-1].element,j=i.DropDownList().value().value;j?(h.async.enable=!0,h.async.url=h.async.rawUrl+j):h.async.enable=!1}h.index=c,h.onSelectedValueRaw=h.onSelectedValue,h.onSelectedValue=e,h.onReset=f,h.onEmpty=f,g.DropDownList(h),d.childs.push({element:g,options:h}),g.data("interlock",d)}function e(a){var b=this.getOptions();b.onSelectedValueRaw&&b.onSelectedValueRaw.call(this,a);var c=b.index,d=b.target,e=d.data("interlock"),f=e.childs;if(c<f.length-1){var h=f[c+1];g(h.element,{async:{enable:!0,url:h.options.async.rawUrl+a.value}})}}function f(){var a=this.getOptions(),b=a.index,c=a.target,d=c.data("interlock"),e=d.childs;if(b<e.length-1){var f=e[b+1];f.element.DropDownList().empty()}}function g(a,b){var c=a.DropDownList();c.setOptions(b),c.reset()}var h=b.registerNameSpace("Controls");a.fn.InterLock=function(c){"{0}_InterLock".bformat(b.DESIGNATION);if(0==this.length)return null;var d=a(this.eq(0)),e=d.data("dataKey");return e||(c=a.extend(!0,{},{},c),c.target=d,e=new h.interlock(c),d.data("dataKey",e)),e},h.interlock=function(b){var e={};b=a.extend(!0,{},e,b);var f=c(b),g=[],h=this;this.add=function(a){return g.push(a),h},this.exec=function(){return a.each(g,function(a,b){d(b,a,f)}),h}},h.interlock.empty=function(){var a=new h.interlock;return a.add=exec=function(){return this},a}()}(jQuery,Beyondbit),function(a,b){function c(b){var c=a.extend(!0,{controls:null,target:null},{},b);return d(c),c}function d(){}var e=b.registerNameSpace("Controls");a.fn.Regulate=function(c){var d="{0}_Regulate".bformat(b.DESIGNATION);if(0==this.length)return null;if(!c)return this.eq(0).data(d);var f=this.eq(0);c=a.extend(!0,{},{target:f},c);var g=e.Regulate.create(c);return f.data(d,g),g};var f=e;f.Regulate=function(b){b=c(b);var d=a(b.controls);this.disabled=function(a){return 0==a?d.removeAttr("disabled"):d.attr("disabled","disabled"),this},this.show=function(a){return 0==a?d.addClass("hide"):d.removeClass("hide"),this},this.hide=function(){return this.show(!1)}},f.Regulate.create=function(a){return new f.Regulate(a)}}(jQuery,Beyondbit),function(a,b){function c(c){var d=a("#"+c.sender.id);if(0==d.length){var e=c.options;d=a(('<div id="{0}" class="'+b.DESIGNATION+'_controls_select {1}">&nbsp;</div>').bformat(c.sender.id,e.className));var f=('<span><em><i class="fa fa-angle-double-down"></i></em><label><input type="text" name="'+b.DESIGNATION+'.key" placeholder="{0}" /></label></span>').bformat(c.options.placeholder);f+="<ul></ul>",f=('<div class="'+b.DESIGNATION+'_controls_select_container"><div>{0}</div></div>').bformat(f),d.append(f);var g=0==e.minWidth?e.width:e.minWidth,h=e.maxWidth<e.width?e.width:e.maxWidth,i=a(".{0}_controls_select_container".bformat(b.DESIGNATION),d);e.width>0&&d.width(e.width),g>0&&(d.css("min-width",g),i.css("min-width",g)),h>0&&d.css("max-width",g),c.options.warpElement.call(c,d),c.rootElement=d}}function d(a){var c=a.rootElement;c.find(":text[name='{0}.key']".bformat(b.DESIGNATION)).val("").data("prevselecttext",null)}function e(b,c){var d=c.find("ul");return d.html("").data("bfcl_data",b),b&&0!=b.length?void a.each(b,function(b,c){var e=a('<li class="{3}"><a href="#" data-value="{1}" data-name="{2}" title="{0}">{0}</a></li>'.bformat(c.text,c.value,c.name,c.noCheck?"noSelect":""));e.data("bfcl_data",c),d.append(e)}):void d.append("<li class='empty'>无数据!</li>")}function f(a,b){if(b){var c=a.rootElement,d=c.find("ul li a[data-value='{0}']".bformat(b));return d.data("name")}}function g(c,d,e){if(d=d||c.sender.value(),d&&d.value){var f=c.rootElement,e=e||f.find("ul li a[data-value='{0}']".bformat(d.value)).parent();e.addClass("selected").siblings().removeClass("selected"),d.name=d.name||e.find("a").data("name"),a(":text[name='{0}.key']".bformat(b.DESIGNATION),f).val(d.name).data("prevselecttext",d.name)}}function h(c){var d=c.sender,f=c.rootElement;if(1!=f.data("bfcl_bindevent")){f.data("bfcl_bindevent",!0);var h=a(":text[name='{0}.key']".bformat(b.DESIGNATION),f);f.find("ul").click(function(b){var e=a(b.target),f=e.parent();if(e.is("a")&&f.is("li:not(.empty,.noSelect)")){var h=f.data("bfcl_data");return g(c,h,f),d.value(h),d.expand(!1),!1}return!1}),h.keyup(function(){var b=a(this),g=b.val(),h=c.options;h.onSearch.call(this,h,c.data,g,function(a){d.expand(!0),a=k(a,h),e(a,f)},c)}),f.click(function(a){a.stopPropagation()}),f.find("em").click(function(){d.expand(!0)}),a("body").click(function(){d.expand(!1)})}}function i(b,c,d,e,f){var g=a(this),h=g.data("previousKeywords")||"";if(d=a.trim(d),d!=h){if(g.data("previousKeywords",d),""===d)return void e(f.data);if(0==b.searchMode){var c=c,i=a.grep(c,function(a){return 0==a.text.indexOf(d)});e(i)}else if(1==b.async.enable){f.sender.loading(),f.searchCurrentXhq&&f.searchCurrentXhq.abort();var j=a.extend(!0,{url:b.async.url,dataType:"json",data:{maxLength:b.maxLength,keywords:d},success:function(a){e(l(a))},error:function(){}},b.async),k=a.ajax(j);k.then(function(){f.searchCurrentXhq=null},function(){f.searchCurrentXhq=null}),f.searchCurrentXhq=k}}}function j(b,c){if(b.source)return void c(l(b.source));if(1==b.async.enable){var d=a.extend(!0,{url:b.async.url,dataType:"json",data:{maxLength:b.maxLength},success:function(a){c(l(a))},error:function(){}},b.async);a.ajax(d)}else c([])}function k(a,b){var c=b.maxLength;return a.length>c&&(a=a.slice(0,c)),a}function l(b){return b?(a.each(b,function(a,b){b.name=b.name||b.text,b.text=b.text||b.name}),b):b}a.fn.DropDownList=function(c){var d="{0}_Select".bformat(b.DESIGNATION);return 0==this.length?this:c?(c=a.extend(!0,{},{},c),this.each(function(b,e){var f=a(e),g=f.data(d);g||(c.target=f,g=new m.select(c),f.data(d,g))}),this):this.eq(0).data(d)};var m=b.registerNameSpace("Controls");m.select=function(l){function n(a){a=k(a,l),o.data=a,e(a,o.rootElement),g(o)}l=a.extend(!0,{id:"",target:null,placeholder:"请选择",async:{enable:!1,url:null},width:0,minWidth:0,maxWidth:0,className:null,splitChar:",",selectValueToControl:null,selectTextToControl:null,onSelectedValue:null,makeText:m.makeText,makeValue:m.makeValue,warpElement:function(a){this.options.target.before(a)},onReset:null,onEmpty:null,maxLength:1e5,searchMode:0,onSearch:i},{},l),l.target=l.target||l.selectValueToControl||l.selectTextToControl;var o={options:l,sender:this};this.inner=o;var p=l.id||l.target.attr("id");p||(p=getGuidGenerator()),this.id=b.DESIGNATION+"_controls_select_{0}".bformat(p);var q=this;this.setOptions=function(b){o.options=a.extend(!0,{},o.options,b)},this.getOptions=function(){return a.extend(!0,{},o.options,{})},this.reset=function(){d(o),this.value({text:"",value:""},!1),j(o.options,n),l.onReset&&l.onReset.call(q)},this.empty=function(){d(o),this.value({text:"",value:""},!1),n([]),l.onEmpty&&l.onEmpty.call(q)};var r={};this.value=function(a,b){if(!a){var c={text:l.makeText.get.call(o)[0]||r.name||r.text,value:l.makeValue.get.call(o)[0]||r.value};return!c.text&&c.value&&(c.text=f(o,c.value)),c}r=a,l.makeText.set.call(o,a),l.makeValue.set.call(o,a),0!=b&&l.onSelectedValue&&l.onSelectedValue.call(q,a)},this.expand=function(a){var c=o.rootElement;if(a)c.addClass("{0}_controls_select_hover".bformat(b.DESIGNATION));else{c.removeClass("{0}_controls_select_hover".bformat(b.DESIGNATION));var d=c.find(":text[name='{0}.key']".bformat(b.DESIGNATION));d.val(d.data("prevselecttext"))}return this},this.destory=function(){this.rootElement.remove()},this.loading=function(a){a=a||"加载中...";var b=o.rootElement,c=b.find("ul");return c.html("<li class='empty'>{0}</li>".bformat(a)),this},c(o),h(o),this.loading(),j(o.options,n)}}(jQuery,Beyondbit),function(a,b){function c(){return b.CultureInfo.Current.getRegional(z.Uploader.regional)}function d(b,d){var j=m(b),k=WebUploader.create(j);return k.on("error",function(d){switch(d){case"Q_EXCEED_NUM_LIMIT":f.call(b,c().errorMessage.Q_EXCEED_NUM_LIMIT.bformat(j.fileNumLimit),arguments);break;case"F_DUPLICATE":f.call(b,c().errorMessage.F_DUPLICATE,arguments);break;case"F_EXCEED_SIZE":var e=arguments[1],g=arguments[2];f.call(b,c().errorMessage.F_EXCEED_SIZE.bformat(g.name,r(e)),arguments);break;case"Q_EXCEED_SIZE_LIMIT":var e=arguments[1],g=arguments[2];f.call(b,c().errorMessage.Q_EXCEED_SIZE_LIMIT.bformat(g.name,r(e)),arguments);break;case"Q_TYPE_DENIED":var g=arguments[1],h=a.map(j.accept,function(a){return"{0}[{1}]".bformat(a.title,a.extensions)}).join(",");f.call(b,c().errorMessage.Q_TYPE_DENIED.bformat(g.name,h),arguments);break;default:f.call(b,c().errorMessage.OTHER.bformat(d),arguments)}return!1}),k.on("uploadError",function(a,c){return g(b,a,c),!1}),k.on("fileQueued",function(a){return h(b,d,a),!1}),k.on("filesQueued",function(){return!1}),k.on("uploadSuccess",function(a,c){return 1==c.Flag?e(b,a,c):g(b,a,c.Message),!1}),k.on("fileDequeued",function(a){return t(a).remove(),!1}),k.on("uploadProgress",function(a,c){return i(b,a,c),!1}),k}function e(b,d,e){var f=e.identity||e.id;if(b.onUploadSuccess){var g=b.onUploadSuccess(d,f,e);if(g)return}var h=t(d);h.data("identity",f),h.addClass("uploader-item-success").attr("title",c().uploadSuccessText),a(".uploader-item-tip",h).html("").attr("title",""),v(d)}function f(a){return this.onError?(this.onError(a,arguments),!1):void u(a)}function g(a,b,c){return a.onUploadError?void a.onUploadError(b,c):void s(b,c)}function h(a,b,c){return a.onUploadFileQueued?void a.onUploadFileQueued(c):void q.call(a,b,c)}function i(b,d,e){if(b.onUploadProgress)return void b.onUploadProgress(d,e);var f=100*e;1==e&&(f=99);var g=t(d);a(".uploader-item-tip",g).html("[{0}%]".bformat(f)).attr("title",c().uploadProgressText.bformat(f)),a(".uploader-item-progress-percentage",g).css("width",+f+"%")}function j(b){var d=a.extend(!0,{container:null,button:null,swf:null,server:null,auto:!0,multiple:!0,fileSizeLimit:null,fileNumLimit:null,fileSingleSizeLimit:null,buttonText:c().uploadButtonDefaultText,onUploadFileQueued:null,onUploadSuccess:null,onUploadProgress:null,onUploadError:null,onUploadAccept:null,onUploadComplete:null,onError:null,onRemoveFile:null,onGetFile:null,onAppendFile:null,items:[],isEditable:!0,mode:1},{},b);return k(d),d}function k(a){l(a,"swf",null),l(a,"server",null)}function l(a,b,c){if(a[b]==c)throw new Error("参数配置不正确")}function m(b){var c=a.extend(!0,{},{},b),d=c.container;return d?(c.dnd="#{0} > .uploader-picker".bformat(d.attr("id")),c.pick=a(".uploader-picker > a",d)):c.pick=b.button,c.disableGlobalDnd=!0,c}function n(a){a.container&&o(a)}function o(c){var d=c.container,e=b.getIdentity(),f='<div class="uploader-picker">		<a href="#" class="btn">			{buttonText}		</a>	</div>	<div class="uploader-items">		<ul>		</ul>	</div></div>';f=f.bformat(c),d.attr("id")||d.attr("id","uploader"+e),d.html(f),0==c.isEditable&&a(".uploader-picker",d).remove(),c.items&&c.items.length>0&&a.each(c.items,function(a,b){b.id=y+b.identity,q.call(c,d,b,b.identity)})}function p(b,c){var d=b.container;if(d){var e=a(".uploader-items > ul",d);0==b.isEditable&&a(".uploader-item-remove",e).remove(),e.click(function(d){var e=a(d.target);if(e.is(".uploader-item-remove")){var f=e.parent(),g=f.data("file"),h=f.data("identity")-0;if(b.onRemoveFile&&0==b.onRemoveFile(h))return;-1==g.id.indexOf(y)&&c?c.removeFile(g,!0):t(g).remove()}})}}function q(b,c,d){if(null!=b){c.sizefriendy=r(c.size);var e=a(".uploader-items > ul",b),f=a("<li></li>");f.append('<span class="uploader-item-tip"></span><a href="#" id="{id}">{name}</a><em>({sizefriendy})</em>'.bformat(c)),f.append(' <i class="fa fa-remove uploader-item-remove"></i>'),w(c,f),f.data("file",c),f.data("identity",d),e.append(f);var g=this;f.find("a").click(function(){var b=a(this),c=b.parent(),d=(c.data("file"),c.data("identity")-0);return g.onGetFile?g.onGetFile(d):void 0}),g.onAppendFile&&g.onAppendFile(c,d)}}function r(a){return WebUploader.formatSize(a)}function s(b,d){var e=t(b);e.addClass("uploader-item-error").attr("title",c().uploadErrorTextFormat.bformat(d)),a(".uploader-item-tip",e).html(c().uploadFailText).attr("title",""),v(b)}function t(b){return a("#"+b.id).parent()}function u(a){b.Web.MessageBox.alert(c().uploadWaringTitle,a,null,"WARNING")}function v(b){var c=t(b);a(".uploader-item-progress",c).remove()}function w(a,b){-1==a.id.indexOf(y)&&b.append('<span class="uploader-item-progress"><span class="uploader-item-progress-percentage" style="width: 0;"></span></span>')}var x=b.registerNameSpace("Controls"),y="exists_file_",z=x;z.Uploader=function(a){a=j(a),n(a);var b,c=a.container;1==a.isEditable&&(b=d(a,c)),p(a,b),this.upload=function(){b.upload()},this.stop=function(){b.stop()}},z.Uploader.regional=[],z.Uploader.regional[""]=z.Uploader.regional["zh-CN"]={errorMessage:{Q_EXCEED_NUM_LIMIT:"上传超过了最大能上传的文件数量, 最多能上传{0}个.",F_DUPLICATE:"文件重复上传",F_EXCEED_SIZE:"文件[{0}]上传失败，单个文件超过了上传文件大小限制，最大只能上传: {1}",Q_EXCEED_SIZE_LIMIT:"文件[{0}]上传失败，所有文件总共大小超过了允许上传大小限制，最大只能上传: {1}",Q_TYPE_DENIED:"文件[{0}]上传失败，上传的文件格式不支持，只允许上传后缀名为: {1}",OTHER:"上传出错了, 原因类型：{0}"},uploadErrorTextFormat:"上传失败：{0}",uploadFailText:"[失败]",uploadSuccessText:"上传成功",uploadProgressText:"上传中，当前进度: {0}%",uploadButtonDefaultText:"上传",uploadWarningTitle:"上传文件警告"},z.Uploader.create=function(a){return new z.Uploader(a)}}(jQuery,Beyondbit),function(a,b){var c=b.registerNameSpace("Controls"),d=c;c.val=function(b,c){return b?c||"string"==a.type(c)?(b.is("div,span")?b.html(c):b.val(c),b):b.is("div,span")?b.html():b.val():void 0},c.makeText={get:function(){return(d.val(this.options.selectTextToControl)||"").splitRemoveEmptys(this.options.splitChar,null,!0)},set:function(a){this.options.selectTextToControl&&d.val(this.options.selectTextToControl,a.name||a.text)}},c.makeValue={get:function(){return(d.val(this.options.selectValueToControl||this.options.target)||"").splitRemoveEmptys(this.options.splitChar,null,!0)},set:function(a){d.val(this.options.target,a.value),this.options.selectValueToControl&&d.val(this.options.selectValueToControl,a.value)}}}(jQuery,Beyondbit);